Step 0: Check requirements
==========================
* PHP 5.2.2 or newer
* Sphinx 0.9 or newer
* FluxBB 1.4.x


Step 1: Install Sphinx
======================
* [Install Sphinx](http://sphinxsearch.com/docs/manual-0.9.9.html#installation) on your server (check if a package is avalaible for your distro).


Step 2: Prepare your FluxBB database
====================================
* Add FluxSphinx table in your FluxBB databases, be careful, check the table prefix:
~~~
CREATE TABLE IF NOT EXISTS `fluxbb_search_sphinx` (
  `action` varchar(64) NOT NULL DEFAULT '',
  `param` int(11) DEFAULT NULL,
  `created` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  KEY `search_sphinx_action` (`action`),
  KEY `search_sphinx_created` (`created`)
);
INSERT INTO `fluxbb_search_sphinx` (`action`, `param`) VALUES ('counter_posts', 0);
INSERT INTO `fluxbb_search_sphinx` (`action`, `param`) VALUES ('tmp_counter_posts', 0);
~~~


Step 3: Setup Sphinx
====================
* Apply configuration (sphinx/sphinx.conf)
* Creating the index:
~~~
/usr/bin/indexer --config /etc/sphinx/sphinx.conf --all --rotate
~~~
* Starting the search daemon:
~~~
/usr/bin/searchd --config /etc/sphinx/sphinx.conf
~~~
OR
~~~
/etc/init.d/searchd start
~~~


Step 4: Configure Cronjobs
==========================
~~~
3,18,33,48 * * * * /usr/bin/indexer --quiet --config /etc/sphinx/sphinx.conf fluxbb_search_posts_delta --rotate >/dev/null 2>&1
30 4 * * * /usr/bin/indexer --quiet --config /etc/sphinx/sphinx.conf fluxbb_search_posts_main --rotate >/dev/null 2>&1; /usr/bin/indexer --quiet --config /etc/sphinx/sphinx.conf fluxbb_search_posts_delta --rotate >/dev/null 2>&1
~~~


Step 5: Setup FluxBB
====================
* Add Sphinx configuration to your FluxBB's config.php:
~~~
// Sphinx
$sphinx_config = array(
    'host' => 'localhost', // Your sphinx server host
    'port' => 3312, // Your sphinx server port
    'idx_main' => 'fluxbb_search_posts_main', // Main search index
    'idx_delta' => 'fluxbb_search_posts_delta', // Delta search index
    'max_query_time' => 5000, // Timeout search queries after 5 seconds.
    'weights' => array( 'message' => 10, 'subject' => 40 ) // Sets the weighting of certain columns
);
~~~
* If Sphinx PHP API isn't on your system, [download it](http://code.google.com/p/sphinxsearch/source/browse/trunk/api/sphinxapi.php) and add it to include folder.
* Add fluxbb/include/sphinx.php to __include__ folder.
* Add fluxbb/lang to __lang__ folder.
* Replace __search.php__ by fluxbb/search.php.